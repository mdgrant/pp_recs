# Acute Pain Management in the Perioperative Setting (2012)

The complete guideline can be found [here.](https://pubs.asahq.org/anesthesiology/article/116/2/248/12956/Practice-Guidelines-for-Acute-Pain-Management-in)

```{r}
#| echo: false
gt_theme_mg <- function(data) {
  data %>%
    opt_row_striping() |>
    opt_table_lines(extent = "none") |>
    # opt_table_font(
    #   font = list(
    #     google_font(name = "Source Sans Pro")
    #   )
    # ) |>
    # opt_table_font(stack = "Source Sans Pro") |>
    tab_options(
      table.font.color = "black",
      table.font.names = "Source Sans Pro",
      data_row.padding = px(2),
      table.font.size = px(13), # ?12
      column_labels.font.size = px(13),  # ?12
      table.align = "left",
      table_body.border.bottom.width = px(1.7),
      table.border.top.width = px(1.7),
      table_body.border.bottom.color = "#9A9EA1",
      table.border.top.color = "#9A9EA1",
      table_body.border.bottom.style = "solid",
      table.border.top.style = "solid",
      column_labels.border.bottom.color = "#9A9EA1",
      column_labels.border.bottom.style = "solid",
      column_labels.border.bottom.width = px(1.3),
      column_labels.font.weight = "bold",
      column_labels.padding = px(3),
      heading.align = "left",
      footnotes.padding = px(0),
      footnotes.font.size = px(12),
      source_notes.padding = px(0),
    ) |>
    opt_horizontal_padding(scale = 2) |>
    tab_style(
      style = list(cell_text(weight = "bold")),
      locations = cells_row_groups()
    ) |>
    opt_footnote_marks(marks = "letters") |>
    opt_footnote_spec(spec_ref = "^x", spec_ftr = "^x") |>
  opt_css(
    css = "
    #one .gt_footnote_marks {
    font-style: normal;
    font-weight: normal;
    font-size: 85%;
    vertical-align: 0px;
    }
  "
  )
}

```

```{r recommendations}
#| echo: false
library(tidyverse)
library(janitor)
library(kableExtra)
library(gt)
library(gtExtras)

recs_dat <- readxl::read_xlsx("_data/pp_recs_all.xlsx", sheet = "Guidelines", range = "A1:F485") |> 
  filter(str_detect(parameter, "Acute Pain"))

# sections <- recs_dat |>
#   select(rec_title) |> 
#   distinct()

recs_dat |> 
  select(rec, rec_title, evidence) |> 
  group_by(rec_title) |> 
  gt() |> 
  fmt_markdown(columns = c(rec)) |> 
  cols_label(
    rec              = "Recommendation",
    evidence         = "Strength of Evidence"
  ) |> 
  cols_width(
    rec              ~ px(600),
    evidence         ~ px(150)
  ) |> 
  gt_theme_mg() 

```

## Evidence Rating Scheme

***Category A***: Supportive Literature Randomized controlled trials report statistically significant (P \< 0.01) differences between clinical interventions for a specified clinical outcome.<br/>
*Level 1*: The literature contains multiple RCTs, and aggregated findings are supported by meta-analysis.<br/>
*Level 2*: The literature contains multiple RCTs, but the number of studies is insufficient to conduct a viable meta-analysis for the purpose of the Guidelines.<br/>
*Level 3*: The literature contains a single randomized controlled trial.

**Category B**: Suggestive Literature Information from observational studies permits inference of beneficial or harmful relationships among clinical interventions and clinical outcomes.

**Level 1**: The literature contains observational comparisons (e.g., cohort, case-control research designs) of clinical interventions or conditions and indicates statistically significant differences between clinical interventions for a specified clinical outcome.

**Level 2**: The literature contains noncomparative observational studies with associative (e.g., relative risk, correlation) or descriptive statistics.

**Level 3**: The literature contains case reports.

***Category C***: Equivocal Literature The literature cannot determine whether there are beneficial or harmful relationships among clinical interventions and clinical outcomes.

**Level 1**: Meta-analysis did not find significant differences (P \> 0.01) among groups or conditions.

**Level 2**: The number of studies is insufficient to conduct meta-analysis, and (1) RCTs have not found significant differences among groups or conditions or (2) RCTs report inconsistent findings.

**Level 3**: Observational studies report inconsistent findings or do not permit inference of beneficial or harmful relationships.

***Category D***: Insufficient Evidence from Literature The lack of scientific evidence in the literature is described by the following terms.

**Inadequate**: The available literature cannot be used to assess relationships among clinical interventions and clinical outcomes. The literature either does not meet the criteria for content as defined in the "Focus" of the Guidelines or does not permit a clear interpretation of findings due to methodological concerns (e.g., confounding in study design or implementation).

**Silent**: No identified studies address the specified relationships among interventions and outcomes.
